<!DOCTYPE html>
<html lang="en">
  <head>
    <title>View Cart - Lightspeed Global - Model Kits, Paints, and More</title>
    <meta
      name="description"
      content="View Cart - Lightspeed Global is your destination for high-quality paints, finishing products, tools, and supplies. Explore a vast range of model kits, including wargames, puzzles, toys, and more."
    />
    <!-- Placeholder for common head content -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("/meta/head.html")
          .then((response) => response.text())
          .then((data) => {
            document.head.innerHTML = data + document.head.innerHTML;
          });
      });
    </script>
  </head>

  <body>
    <!-- Header PlaceHolder -->
    <div id="header-placeholder"></div>

    <!-- Navigation Menu PlaceHolder -->
    <div id="navigation-menu-placeholder"></div>

    <!-- Main Content -->
    <main
      style="max-width: 1200px"
      class="mx-auto px-3 lg:px-0 mt-1 mb-20 overflow-hidden"
    >
      <!-- Categories Slider PlaceHolder -->
      <div id="cart-view-placeholder"></div>
    </main>

    <!-- Footer PlaceHolder -->
    <div id="footer-placeholder"></div>

    <!-- JavaScript -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <script>
      // Define the `isAdmin` flag
      const isAdmin = true; // Change to false if the user is not an admin

      // Define an async function to handle the sequential loading
      async function loadComponents() {
        try {
          // Load header
          const headerResponse = await fetch("/layout/header.html");
          const headerData = await headerResponse.text();
          document.getElementById("header-placeholder").outerHTML = headerData;

          // Load navigation
          const navigationResponse = await fetch("/layout/navigation.html");
          const navigationData = await navigationResponse.text();
          document.getElementById("navigation-menu-placeholder").outerHTML =
            navigationData;

          // Load categories slider
          const cartViewResponse = await fetch("/snippets/cart-view.html");
          const cartViewData = await cartViewResponse.text();
          document.getElementById("cart-view-placeholder").outerHTML =
            cartViewData;

          // Load products table and render products
          const productsTableResponse = await fetch(
            "/snippets/products-table.html"
          );
          const productsTableData = await productsTableResponse.text();
          document.getElementById("products-table-placeholder").outerHTML =
            productsTableData;

          // Load footer
          const footerResponse = await fetch("/layout/footer.html");
          const footerData = await footerResponse.text();
          document.getElementById("footer-placeholder").outerHTML = footerData;
        } catch (error) {
          console.error("Error loading components:", error);
        }
      }

      // Helper function to dynamically load external scripts
      function loadScript(src) {
        return new Promise((resolve, reject) => {
          const script = document.createElement("script");
          script.src = src;
          script.onload = resolve;
          script.onerror = reject;
          document.body.appendChild(script);
        });
      }

      // Call the function on DOM content loaded
      document.addEventListener("DOMContentLoaded", async function () {
        // First, wait for the components to load
        await loadComponents();

        // After loadComponents is done, load the other scripts
        try {
          await loadScript("/scripts/cart-view.js");
          await loadScript("/scripts/products-data.js");
          console.log("All scripts loaded successfully");
        } catch (error) {
          console.error("Error loading external scripts:", error);
        }
      });
    </script>
  </body>
</html>
